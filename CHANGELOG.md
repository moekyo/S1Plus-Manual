## [Unreleased]

### ✨ 新增与增强 (Features & Enhancements)

- **屏蔽用户备注功能升级**:
  - **自定义编辑弹窗**: 全新设计的备注编辑弹窗，替代原生的浏览器输入框。支持多行输入 (`textarea`)，自动显示当前用户名，交互体验更佳。
  - **列表 UI 重构**: 重新设计了屏蔽用户列表的布局，将备注显示、开关和操作按钮整合在同一行，节省空间并提升美观度。
  - **样式优化**: 优化了备注文本的背景颜色（适配深色模式）、对齐方式（右对齐）和圆角样式（8px），使其与整体系更统一。
  - **快捷操作**: 在列表中新增了直观的“添加备注”和“编辑”按钮，操作更便捷。


### 🎨 UI/UX 与样式优化 (UI/UX & Style)

-   **统一设置面板展开/收起动画**: 将"已屏蔽的楼层"分组列表的展开/收起动画从 `max-height` 方案迁移到 `grid-template-rows` 方案，与其他可折叠内容（如"关键字屏蔽列表"、"手动屏蔽列表"）保持一致。统一了动画时长（0.4s）和缓动函数（Material Design 标准缓动），并使用 `!important` 覆盖 NUX 的全局过渡规则干扰，确保所有列表动画速度一致。
-   **优化跨平台字体渲染**: 使用 `system-ui` 字体栈优先选择各平台最佳系统字体（Windows: 微软雅黑，macOS: 苹方，Linux: Noto Sans CJK），并移除强制字体平滑设置，让各平台使用默认的最优渲染方式（Windows 的 ClearType 子像素抗锯齿，macOS 的 antialiased），解决了 Windows 下文字锯齿问题。
-   **优化楼层分组展开间距**: 调整"已屏蔽的楼层"列表中帖子分组展开时的垂直间距，移除顶部内边距，使列表内容更紧凑贴合标题。
-   **统一展开/收起箭头位置**: 将设置面板中所有可折叠列表的展开/收起箭头统一放置在右侧，包括"关键字/规则屏蔽列表"、"手动屏蔽帖子列表"以及楼层分组标题等，提升了界面的视觉一致性。
-   **优化楼层分组显示**: 为"已屏蔽的楼层"列表中的帖子分组添加折叠/展开功能，并记住用户的折叠状态，优化了大量已屏蔽楼层时的浏览体验。

-   **优化深色模式输入框**: 为设置面板中的所有输入框在深色模式下增加了新的 `:focus` 样式，使其在被激活时有更清晰的视觉反馈，提升了可用性。
-   **行内确认菜单交互升级**:
    -   为屏蔽确认菜单添加了平滑的展开/收起动画。
    -   优化了输入框在新布局下的显示效果，确保在深色模式下的视觉一致性。
-   **帖内工具栏图标化**: 将帖子楼层工具栏中的文字操作按钮（只看该用户、收藏该回复、屏蔽用户/楼层、标记用户）全面升级为现代化的 SVG 图标按钮，并添加了完善的悬停提示和状态交互，显著提升了界面的整洁度和其实用性。
-   **图标样式适配**: 调整了工具栏图标的颜色渲染策略，使其跟随文字颜色（inherit）并移除透明度，从而更好地适配深色模式和各种主题。
-   **工具栏图标加粗 (Thickened Icons)**: 将帖子楼层工具栏的所有操作图标（如只看该用户、收藏、屏蔽等）更新为线条更清晰的样式。保留了实心填充的设计风格，同时通过增加 0.5px 的描边宽度，实现了“加粗”的视觉效果，既保持了图标的稳重感，又提升了在其在页面上的辨识度。
-   **屏蔽图标优化**: 更新了"屏蔽该用户"和"屏蔽该楼层"的图标，使其更加直观。
-   **动态链接处理优化**: 增强了对“只看该用户”模式切换的响应能力，现在“显示全部楼层”链接也会自动转换为对应的图标按钮，保持了 UI 风格的高度统一。
-   **优化备注按钮尺寸**: 增加了用户备注按钮的尺寸（内边距），使其更易于点击。

### ✨ 新增功能 (Features)

-   **用户标记颜色自定义**: 为用户标记添加了颜色自定义功能，使标记更加醒目。
    -   提供 6 种预设颜色（红、橙、黄、绿、蓝、紫）及默认灰色可供选择。
    -   在编辑弹窗和设置面板中使用自定义圆形按钮作为颜色选择器。
    -   完美适配浅色和深色模式，深色模式下使用更柔和的色调以保证可读性。

-   **历史标记快速选择**: 在用户标记编辑弹窗中新增历史标记列表。
    -   显示所有已使用过的标记，点击即可快速填充标记内容和颜色。
    -   支持瀑布流布局，超长标记截断显示，悬停可查看完整内容。
    -   显示历史标记数量，超过 200px 高度时支持滚动。


-   **楼层屏蔽功能**: 新增针对单个楼层的屏蔽功能。现在你可以在帖子内屏蔽特定的楼层回复，而不需要屏蔽整个用户。该功能：
    -   在每个楼层底部新增"屏蔽该楼层"按钮（当"启用帖子屏蔽功能"开启时显示）
    -   在设置面板的"帖子屏蔽"标签页中新增"已屏蔽的楼层"管理区域，可以查看和取消屏蔽
    -   支持远程同步，楼层屏蔽数据会在不同设备间同步
    -   提供独立的开关控制，可随时启用或禁用该功能

-   **屏蔽用户备注**: 在屏蔽用户时现在可以添加备注信息。
    -   在屏蔽确认弹窗中新增了可展开的备注输入框。
    -   备注信息将显示在设置面板的"屏蔽用户"列表中，支持通过悬浮窗查看完整内容。

-   **系统屏蔽楼层隐藏**: 新增"默认隐藏被系统屏蔽的楼层"设置。
    -   在"阅读/浏览增强"设置中开启后，包含"作者被禁止或删除"提示的楼层将被自动隐藏。
    -   采用 CSS `:has()` 选择器实现，切换开关即时生效，无页面闪烁 (FOUC)。

-   **手动清理阅读记录**: 新增手动清理阅读记录功能。
    -   在"阅读/浏览增强"设置中新增"清理方式"选择，支持"自动"和"手动"两种模式。
    -   手动模式下可选择 30天/180天/365天/自定义天数，点击"立即清理"按钮执行清理。
    -   清理完成后会显示操作结果提示（成功清理 X 条 / 无可清理记录）。
    -   支持远程同步，清理模式设置会在不同设备间同步。

-   **阅读记录详情弹窗**: 新增阅读记录详情查看和管理功能。
    -   在手动清理模式下，可点击"阅读记录详情"按钮查看所有阅读记录的分组统计。
    -   支持 7 个时间分组：今天、本周、本月、3个月内、6个月内、1年内、1年以上。
    -   可对每个分组单独执行删除操作，删除前有二次确认弹窗。
    -   弹窗采用表格化布局，复用同步冲突弹窗样式，视觉风格统一。

### 🚀 功能优化 (Features)

-   **智能同步 V5 (Smart Sync V5)**:
    -   引入 `baseContentHash` (基础数据哈希) 概念，该哈希在计算时会排除阅读进度，从而能更精确地判断云端和本地数据的核心差异。
    -   **无感自动同步**: 当你在浏览帖子时，如果脚本检测到本地与云端的唯一区别仅为当前帖子的阅读进度，它将自动在后台完成同步（推送或拉取），无需任何手动操作。
    -   **清理后自动推送**: 当执行“清理已读帖子进度”操作后，如果基础数据（如黑名单、用户标记等）与云端一致，脚本会自动将清理后的结果推送到云端。

### 🐛 问题修复 (Bug Fixes)

-   **修复禁用 NUX 时设置面板样式异常**: 修复了当系统处于深色模式但 S1 NUX 主题未启用（即论坛实际为浅色模式）时，设置面板中多个元素样式异常的问题：
    -   输入框获得焦点时背景变为深色，与浅色面板不协调
    -   删除按钮的 SVG 图标被渲染为白色，在浅色背景下几乎不可见
    -   "已同步至论坛黑名单"标识的背景过深、文字难以辨认
-   修复了楼层屏蔽取消屏蔽按钮的悬停高亮色问题，现在悬停时显示与其他取消屏蔽按钮一致的红色效果。
-   修复了"已屏蔽的楼层"列表中，分组标题在收起状态下的垂直对齐问题（通过添加 padding 过渡动画实现）。
-   修复了"清理阅读进度"后未正确更新本地数据时间戳的问题，此修复是实现新版智能同步功能的基础。
-   **修复手动清理模式下仍自动清理的问题**: 修复了即使用户选择"手动"清理模式，脚本在初始化或同步时仍会自动清理阅读记录的问题。现在 `cleanupOldReadProgress` 函数会正确检查 `cleanupMode` 设置。
-   **修复清理标记残留导致的同步异常**: 修复了多处场景下 `s1p_pending_cleanup_info` 清理标记未被正确清除的问题，该问题可能导致在手动模式下点击同步按钮时误触发"自动清理后推送"的逻辑。现在以下场景都会正确清除该标记：
    -   切换到手动清理模式时
    -   将自动清理天数设为"永不"时
    -   强制推送/拉取成功后
    -   通过"阅读记录详情"删除分组后（新增设置标记，与手动清理行为保持一致）
-   **修复默认颜色勾选图标不可见**: 修复了在浅色模式下，用户标记设置中默认颜色选项（无色/透明）的选中状态图标颜色为白色导致不可见的问题，现已调整为跟随主题色。

### 🔧 技术改进 (Refactoring)

-   云端同步的数据结构升级至 `v5.0`，以支持新的 `baseContentHash` 字段，并确保对旧版数据的兼容性。

---

## [v6.2.1] - 2025-10-23

### Fixed
- 修复了因“自动清理阅读记录”功能导致的一系列同步问题。当自动清理触发后，脚本现在会正确处理本地与云端的数据差异，避免了可能出现的同步冲突、循环弹窗或每日设置被重置的 Bug。
- 调整了启动时同步冲突的检测优先级，使其高于“强制拉取”，以防止在存在冲突时意外覆盖本地数据。

---

## [v6.2.0] - 2025-09-25

### ✨ 新增与增强 (Features & Enhancements)

- **新增版本更新亮点**：首次更新到 v6.1.0 的用户将会看到一个“更新亮点”弹窗。此弹窗旨在主动介绍本次重构后的远程同步功能，包括其智能无感同步、后台自动推送和更清晰的冲突解决机制，以提升新功能的可见度和用户体验。同时，优化了弹窗的显示逻辑，避免其与“S1 NUX 主题推荐”弹窗发生冲突。
- **帖子详情页智能同步**: 新增核心功能，当用户在帖子详情页内手动同步时，若云端与本地的数据差异仅为当前帖子的阅读进度，脚本将自动合并进度并完成一次无感、无刷新的后台同步，极大提升了阅读时的同步体验。
- **新增“启动时强制拉取”选项**: 在“同步设置”中增加了一个新的高级选项。启用后，每日首次加载时，如果云端与本地数据不一致，脚本将总是使用云端数据覆盖本地版本。此功能旨在帮助用户在多设备同步时，快速统一以云端为准的数据状态，但请注意：它可能会覆盖本地未及时同步的修改。
- **消息提醒屏蔽**: 在用户的“提醒”页面，会自动折叠并隐藏来自已屏蔽用户的消息，并提供一个可点击展开/折叠的占位符，以减少干扰。
- **重构“在新标签页打开”功能**:
  - 彻底重写了链接类型判断的核心逻辑，采用基于优先级的新机制，解决了旧逻辑因执行顺序导致的行为不一致问题，使链接识别更精确、更可靠。
  - 重新组织并简化了相关设置项，使其结构更清晰、更易于理解。
  - 更新了设置界面的布局和文案，与新的设置项保持同步。
  - 增强了数据迁移脚本，确保旧版本用户的设置能够平滑过渡到新结构。

### 🐛 修复与优化 (Bug Fixes & Optimizations)

- **修复**: 修复了远程同步功能可能因 API 缓存而导致数据更新不及时的问题。
- **优化帖子操作菜单交互体验**：为帖子列表中的“三点操作菜单”按钮（.s1p-options-btn）增加透明的“交互桥梁”伪元素，解决按钮与菜单之间的物理间隙导致菜单易消失的问题。大幅缩减桥梁宽度，防止影响相邻元素，显著提升操作菜单的易用性和交互流畅度。
- **优化用户标签弹窗交互**: 改进了用户标签编辑弹窗的关闭逻辑。现在弹窗需要点击外部区域才会关闭，取代了之前鼠标移开后自动关闭的行为。此举解决了在使用输入法或快速移动鼠标时弹窗意外消失的问题，使编辑体验更加稳定。
- **修复 UI 元素跨平台对齐问题**: 修正了在不同操作系统（特别是 Windows）下，“同步数据”弹窗内徽章（例如“有更新”、“+5”）的垂直对齐问题。通过统一字体并改用 Flexbox 布局，确保了各类徽章在所有平台下都能精确对齐，提升了视觉一致性。
- **修正并增强帖子详情页智能同步**: 彻底重构了帖子详情页的智能同步逻辑。旧逻辑在判断云端与本地仅有当前帖子进度差异时，会固定执行“拉取合并”操作，可能导致本地最新的阅读进度被覆盖。新逻辑在此基础上增加了时间戳判断，实现了真正的双向同步：
  - **无感推送**: 当本地数据较新时（例如用户持续阅读），会自动将最新进度推送到云端。
  - **无感拉取**: 当云端数据较新时（例如在另一设备上阅读后打开本设备），会自动拉取云端数据并合并当前页面的阅读进度。
    此项修复确保了在多设备间交替阅读同一帖子时，阅读进度始终能被正确、无冲突地合并。
- **修复** 帖子列表中的“三点操作菜单”在鼠标移入时可能意外消失的问题。通过优化菜单的触发区域，解决了按钮与菜单主体之间的交互“断层”，提升了操作的流畅性和可靠性。
- **优化启动同步逻辑**:
  - **防止启动时意外推送**: 重构了自动同步逻辑，以防止在脚本启动时（例如，打开浏览器或新标签页）自动将本地较新的数据推送到云端。现在，如果检测到本地数据比云端新，脚本会暂停自动同步，并弹窗提示用户手动处理，从而有效避免了因浏览器缓存或离线修改导致的云端数据被意外覆盖的风险。
  - **优化冲突处理体验**: 当启动时检测到上述“本地数据较新”的冲突情况时，会弹出引导式对话框，让用户选择“立即处理”或“稍后处理”，使用户对同步过程有更清晰的掌控。
- **精简同步流程**: 优化了手动同步和部分自动同步流程中的消息提示，减少了不必要的“正在检查...”提示，使交互体验更流畅。
- **优化** 同步逻辑，修复在“强制拉取”或“手动同步”后会触发一次不必要的“推送”操作的问题。
- **修复** 在导入云端数据时，阅读进度跟踪功能可能会与导入操作发生冲突，导致数据不一致的潜在问题。
- **优化** 自动清理旧的阅读进度记录时，不再触发不必要的数据同步。
- **链接与跳转**：修复了“在新标签页打开”功能会错误地应用于帖子楼层内的“回复”、“编辑”按钮以及用户空间子导航栏的问题。

### 🎨 UI/UX 与样式优化 (UI/UX & Style)

- **界面布局**: 调整帖子列表页的悬停屏蔽按钮，将其从行首（左侧）移动到行末（右侧），以改善界面布局和操作流程。
- **Style**: 调整同步弹窗和设置项的 CSS 样式缩进，优化代码格式。
- **手动同步冲突弹窗升级**:
  - **表格化对比**: 彻底重构了手动同步的数据对比弹窗，采用更清晰的表格化界面，逐项展示本地与云端各项数据的数量差异。
  - **智能更新提示**: 当阅读进度数量一致但内容有更新时，会智能标记为 `(内容更新)`，帮助用户决策。
  - **操作历史追溯**: 弹窗中会显示本机上次的手动同步操作（推送/拉取）及时间，为用户提供决策上下文。
- **高级同步模式交互优化**: 统一了导航栏“手动同步”按钮在高级模式下的交互逻辑。现在单击按钮将执行智能判断同步，而鼠标悬停则保留强制推送/拉取的快捷选项，降低了学习成本。
- **优化设置项联动逻辑**: 在“同步”设置中，“启动时强制拉取云端数据”选项现在会与其父选项“每日首次加载时同步”进行联动。只有当父选项开启时，该子选项才可被激活和设置，优化了交互逻辑并避免了无效配置。
- **统一设置项样式**: 统一了各选项卡中子选项分组的缩进和样式，使设置界面的视觉层级更清晰、更一致。
- **视觉修复**: 修正了导航栏中“手动同步”图标的旋转动画方向，并优化了其 SVG 图像数据，使其视觉效果更精确、更符合用户习惯。

### 📦 代码重构与优化 (Refactoring & Other)

- **代码健康度**: 重构了警告文本的样式，将其从内联样式提取为独立的 CSS 类 `.s1p-warning-text`，提高了代码的可维护性和复用性。同时，优化了该样式在深色模式下的颜色，使其更柔和、更易读。

---

## [v6.1.0] - 2025-09-19

### ✨ 新增与增强 (Features & Enhancements)

- **“在新标签页打开”功能重构**：将所有相关选项统一整合到通用设置中，并由一个总开关控制。现在可以独立设置主导航、侧边栏和帖子/版块链接的行为，并支持自动迁移旧版设置。
- **链接处理扩展**：将“在新标签页打开”功能扩展至论坛内几乎所有链接，并重构底层实现以提升性能和稳定性，同时能智能排除登出等特殊链接。
- **论坛黑名单双向同步**：新增将脚本中的屏蔽用户操作自动同步至论坛官方黑名单的功能（反之亦然），可在设置中开启。
- **智能操作保护**：脚本会识别当前登录用户，并自动隐藏对自己帖子的“屏蔽/标记用户”按钮，防止误操作。
- **同步逻辑优化**：分离“每日首次同步”和“常规后台同步”逻辑，优化了多标签页下的同步锁与冲突处理，提升了同步的智能性和安全性。
- **即时操作反馈**：关键字屏蔽规则的删除操作现在会立即生效，无需额外保存。

### 🐛 修复 (Bug Fixes)

- **链接与跳转**：
  - 修复了帖子列表底部的翻页按钮会被“在新标签页打开”功能错误处理的问题。
  - 修复了“阅读进度跳转”按钮的“在新标签页打开”行为不再错误地受全局总开关影响。
- **核心功能**：
  - 修复了多账号切换后，自动签到功能因共享状态而失效的问题，现在将基于 UID 单独记录。
  - 修复了与论坛黑名单同步时，因状态标签导致无法正确读取用户名以及请求标头拼写错误的问题。
  - 恢复了帖子列表中被意外隐藏的原生“新回复”等图标。
- **界面与交互**：
  - 修复了增强型悬浮控件在收起状态下仍会遮挡并拦截页面点击的问题。
  - 修复了设置界面中部分功能开关无法正常展开/折叠其子选项的问题。
  - 修复了设置面板中分段控件在初次展开时滑块位置不正确的问题。
  - 修复了关闭功能模块后，其子选项未同步变为禁用状态的视觉问题。
  - 修复了帖子楼层号在新版布局下偶尔出现的初始闪烁或短暂消失问题。
  - 优化了远程同步失败时的错误提示，使其能显示更具体的原因。
  - 修正了行内确认菜单在屏幕边缘的定位算法，确保其能稳定、精确地显示。

### 🎨 UI/UX 与样式优化 (UI/UX & Style)

- **设置面板**：
  - 对整体 UI 进行了全面优化，统一了字体、字重、尺寸和间距，提升了视觉层级和可读性。
  - 重构了功能项的展开/折叠动画，使其更平滑、性能更好。
  - 微调了部分 UI 元素，移除了不必要的分组标题，使布局更简洁。
- **界面组件**：
  - 优化了 Toast 通知的视觉样式，使其更具辨识度。
  - 对悬浮控件（返回顶部/底部）进行了视觉重构，采用更小巧精致的现代设计。
  - 微调了行内确认菜单（如删除用户标记）的样式，使其更精致、紧凑。
  - 优化了用户标记操作菜单的交互，改为悬停触发，避免意外关闭。
  - 统一了多个 UI 组件（弹窗、菜单、按钮）的样式，移除了边框，使其风格更简约、一致。
- **视觉风格**：
  - 引入统一的阴影颜色变量，并优化了深色模式下的阴影渲染。
  - 优化了阅读进度提示条的出现/消失动画及深色模式下的颜色。

### 📦 代码重构与优化 (Refactoring & Other)

- **代码健康度**：
  - 对脚本代码进行了全面的自动化格式化，统一了代码风格。
  - 清理了大量过时或冗余的开发注释、调试代码、废弃的 CSS 代码及残留的开发日志。
- **逻辑优化**：
  - 优化了全局链接点击事件的处理逻辑，提升了代码的可维护性。
  - 将“导航栏定制”等功能的事件监听逻辑解耦，降低了模块耦合度。
  - 重构了主要功能模块的总开关逻辑，现在关闭功能会从 DOM 中彻底移除其 UI 元素。
  - 将 S1 NUX 主题的推荐间隔延长至 7 天，减少打扰。

### 📝 文档 (Documentation)

- 丰富了“云端同步”功能的描述，增加了关于数据校验、高级模式和状态反馈的详细说明。
- 补充了“界面与导航定制”部分关于新特性的说明。
- 优化了整体文档结构，修正了部分术语和排版，使其内容与功能保持一致。

## [v6.0.0] - 2025-09-14

### ✨ 新增与增强 (Features & Enhancements)

- **S1 NUX 主题深度集成**
  - **安装推荐**: 为了提升综合浏览体验，当检测到用户未安装广受好评的 `S1 NUX` 论坛美化扩展时，会适时进行推荐（可在设置中关闭）。
  - **主题兼容模式**: 新增“跟随 S1 NUX 主题颜色”的开关，开启后脚本 UI（如滚动条、高亮颜色）将完美融入 NUX 主题，关闭则恢复 S1 Plus 经典绿色风格。
  - **删除按钮联动**: 所有删除按钮的样式经过重构，能够根据当前是否使用 NUX 主题自动切换外观，并与主题色进行联动。
- **远程同步体验优化**
  - **智能首次设置**: 彻底重构了首次配置同步的逻辑。保存 Gist ID 和 PAT 后不再盲目同步，而是会启动智能检测流程，引导用户安全地完成首次数据推送或拉取，从根本上解决了本地默认设置意外覆盖云端备份的严重问题。
  - **连接测试**: 保存同步设置后，脚本会自动测试与远程 Gist 的连接。如果凭据无效，会立即给出失败反馈，帮助用户快速定位问题。
  - **后台同步引擎重构**: 后台自动同步不再是简单的推送，而是会执行完整的智能检查，包括冲突检测、智能按需更新，并提供更清晰的状态反馈，最大限度防止数据丢失。
- **核心功能与 UI**
  - **增强型悬浮控件**: 新增一套现代化的悬浮控件（返回顶部/底部、快速回复等），可在设置中与论坛原生控件自由切换。
  - **阅读进度指示器飞跃式升级**:
    - **全新外观**: 指示器经完全重新设计，外观更小巧精致，并增加了流畅的弹出和消失动画。
    - **智能定位**: 指示器会悬浮在帖子标题栏右侧，并智能避开“楼主”等元素，不再挤压标题或被遮挡。
    - **独立开关**: 在设置中增加了独立的开关，允许用户自由控制其显示或隐藏。
  - **滚动条美化**: 脚本现在会美化浏览器滚动条，使其颜色与论坛主题协调一致。
- **设置与交互改进**
  - **统一设置范式**: 设置面板的所有主要功能页被重构为由一个总开关控制的可折叠结构，使禁用或启用一整类功能更加直观。
  - **行内二次确认**: 为用户标记的删除操作添加了独立的行内二次确认菜单，替代了通用的弹窗，交互更流畅稳定。

### 🎨 UI/UX 优化 (UI/UX Improvements)

- **全新 V4 按钮系统**: 全面升级脚本中的所有按钮，采用更精致的阴影和悬停时的“上浮”动画，替代了原有的描边样式，提升了现代感和交互体验。
- **设置面板现代化重构**:
  - 导航 Tabs 从下划线样式重构为现代化的 Pill (药丸) + 滑块样式，并增加了流畅的滑动动画。
  - 重构了所有可折叠区域的展开/收起动画，采用现代 CSS Grid 技术，解决了旧动画存在的布局抖动和性能问题。
  - 为所有删除、恢复默认等危险操作增加了二次确认对话框，防止误操作。
- **交互细节优化**:
  - **危险操作按钮**: 所有危险操作按钮（如删除）默认显示为中性灰色，仅在鼠标悬停时变为红色，以减少视觉干扰。
  - **用户标记菜单**: 触发方式由“点击”改为“鼠标悬停”，彻底解决了菜单意外关闭和闪烁的问题。
  - **帖子列表布局**: 重构优化了帖子列表的布局，通过隐藏原生图标、统一操作列宽度等方式，使其在视觉上更整洁、更稳定。
  - **对齐与样式**: 精细调优了“当前阅读位置”指示器的垂直对齐；优化了收藏夹长链接的截断显示样式；统一了脚本 UI 的主题色。

### 🐛 修复 (Bug Fixes)

- **核心布局问题**:
  - **[重大修复]** 采用现代 Flexbox 技术重写了帖子头部的布局系统，永久性地解决了长用户名、多插件等情况下导致的元素错位、重叠或意外换行的问题。
  - **[重大修复]** 通过动态添加占位单元格，从根本上解决了因脚本注入“操作”列而导致的帖子列表（如作者、回复数）列对齐错位的问题。
- **功能逻辑修复**:
  - 修复了“导入设置”功能会将导入数据与本地数据合并（而非预期地覆盖）的严重问题。
  - 修复了在帖子页面翻页后，阅读进度跟踪功能会失效的 Bug。
  - 修复了收藏包含已屏蔽用户引用的楼层时，会将引用占位符文本一并存入收藏内容的问题。
- **兼容性与 UI 修复**:
  - 修复了在 S1 NUX 主题的窄屏模式下，导航栏按钮因外边距计算错误导致的背景和对齐问题。
  - 修复了行内操作菜单在屏幕左侧边缘显示时，可能因计算错误而被遮挡或定位不准的问题。
  - 修复了删除按钮在 NUX 主题下的悬停样式被覆盖的问题。

### 📦 重构与其他 (Refactoring & Other)

- **代码质量**:
  - 对按钮相关的 CSS 进行重构，统一到 `.s1p-btn` 基类下进行管理，提高了代码的可维护性。
  - 对整个代码库应用了 Prettier 格式化工具，统一了代码风格，并移除了大量过时的注释。
  - 对脚本内注入的所有 CSS 样式进行了统一的格式化，以提高可读性和一致性。
- **其他**:
  - S1 NUX.css 样式表版本号更新至 2025.9.10。

---

## [v5.1.4] - 2025-09-07

### 🐛 修复 (Bug Fixes)

- **增强导航栏稳定性**: 改进了页面变化监测机制 (`MutationObserver`)，使其能够自动检测并修复论坛原生脚本导致的导航栏重置问题。此举确保了“S1 Plus 设置”和“手动同步”等按钮在页面加载和动态更新过程中始终可见，解决了它们可能意外消失的 Bug。

---

## [v5.1.3] - 2025-09-07

### 🚀 功能增强 (Enhancements)

- **新增手动同步高级模式**:
  - 在设置中增加 “启用手动同步高级模式” 选项。
  - **默认模式 (关闭)**: 点击导航栏的同步按钮，将根据本地与云端的时间戳智能判断是“推送”还是“拉取”。
  - **高级模式 (开启)**: 鼠标悬停在同步按钮上时，会浮现一个快捷菜单，允许用户明确选择执行 **强制推送 (Push)** 或 **强制拉取 (Pull)** 操作，给予用户完全的数据流向控制权。
- **重构并优化了行内菜单**:
  - 引入了更通用的 `createInlineActionMenu` 组件，用于创建悬浮菜单，提升了代码的复用性和可扩展性。
  - 为新的高级同步菜单设计了独立的图标和样式，使其与现有 UI 风格保持一致。

---

## [v5.1.2] - 2025-09-07

### ✨ 新增与增强 (Features & Enhancements)

- 优化了多标签页启动时的同步逻辑：通过引入“同步锁”机制，确保了当每日首次访问、同时打开多个论坛标签页时，只有一个标签页会执行同步任务。这避免了潜在的重复操作、不确定的同步结果和页面刷新问题，使启动体验更流畅、更可靠。
- 改进了同步冲突的处理方式：当检测到数据冲突时，不再使用短暂的右下角提示。取而代之的是一个清晰的、阻塞式的对话框，它会主动引导用户选择“立即解决”或“稍后处理”。这使得冲突状态不会被忽略，极大地提升了数据安全性与用户体验。

### 🎨 UI/UX 优化 (UI/UX Improvements)

### 🐛 修复 (Bug Fixes)

- 修复了一个严重的远程数据覆盖问题：修复了一个在特定条件下（通常为重装脚本或清除浏览器缓存后），“每日首次加载自动同步”功能会错误地使用本地默认配置覆盖云端备份的致命 Bug。现在，脚本能够正确识别并拉取云端数据来恢复您的配置，而不是错误地推送本地空配置。

### 📦 重构 (Refactoring)

---

## [v5.1.1] - 2025-09-07

### 🎨 UI/UX 优化 (UI/UX Improvements)

### 🐛 修复 (Bug Fixes)

- 修复了远程同步功能因缺少对 api.github.com 的连接授权，导致被油猴脚本管理器（Tampermonkey）安全策略拦截而无法使用的问题。现在，正确配置了 Gist ID 和 PAT 的用户可以正常使用手动及自动同步功能。

### 📦 重构 (Refactoring)

---

## [v5.1.0] - 2025-09-07

### ✨ 新增与增强 (Features & Enhancements)

- **新增“每日首次加载时同步”功能**：在“设置同步”中增加了一个新的独立开关。启用后，脚本会在每天第一次打开论坛时自动执行一次同步。这对于在不同设备间交替使用的用户非常有用，可以确保总是在最新的数据基础上开始浏览。
- **启动时智能同步与刷新**：重构了脚本启动时的同步逻辑。现在，如果启动时（无论是每日首次同步还是常规的自动同步）从云端拉取了新数据，脚本会显示提示并自动刷新页面。这可以避免在旧数据上进行操作，从根本上保证了数据的一致性。
- **远程同步状态反馈**：导航栏的手动同步按钮现在会通过不同的颜色和动画实时显示同步状态，包括“同步中”、“同步成功”和“同步失败”，让操作结果一目了然。
- **智能同步冲突处理**：当检测到本地与云端数据不一致或存在版本冲突时，脚本会弹出清晰的对话框，展示两边数据的时间戳，并让您自主选择保留哪个版本（推送或拉取），避免数据意外丢失。
- **云端数据损坏保护**：当检测到您的云端备份文件已损坏或校验失败时，脚本会自动暂停同步以保护您当前健康的本地数据，并提供使用本地数据修复云端备份的选项。
- **首次同步引导**：在您首次配置并使用远程同步功能时，脚本会检测到云端备份为空，并引导您将当前的本地设置作为初始版本推送到云端。

### 🎨 UI/UX 优化 (UI/UX Improvements)

- **优化手动同步按钮交互**：极大地增强了导航栏手动同步按钮的视觉反馈。
  - 动画过程中按钮将被锁定，防止重复点击。
- **优化同步按钮视觉表现**：
  - 替换了导航栏手动同步按钮的 SVG 图标，使其更清晰。
  - 调整了图标的大小和垂直位置，以实现与导航栏文本更好的视觉对齐。
  - 简化了同步状态的动画效果，仅保留“同步中”的旋转动画，移除了成功和失败状态的视觉特效，使反馈更简洁。
- 优化了“设置同步”面板的交互逻辑，当远程同步总开关关闭时，下方的所有相关设置项（如 Gist ID、Token 输入框、按钮等）都会被清晰地置为禁用状态。
- 微调了导航栏中手动同步按钮的位置，使其排列更加协调。
- [样式改进] 调整了悬浮提示框（Toast）的默认样式，使其视觉上与脚本的整体主题（如设置面板）更加统一。

### 🐛 修复 (Bug Fixes)

### 📦 重构 (Refactoring)

- **重构 `performAutoSync` 函数**：核心同步函数现在会返回一个详细的状态对象，使其行为（如“已推送”、“已拉取”、“无变化”、“冲突”等）对调用者完全透明，增强了系统的健robustness。
- **重构主流程 `main` 函数**：`main` 函数现在是异步的，并且会等待启动同步流程 `handleStartupSync` 完成。如果检测到页面需要刷新，它会中断后续所有脚本的初始化，避免了不必要的资源消耗。
- 对核心的 `handleManualSync` 函数进行了彻底重构，实现了业务逻辑与 UI 表现的完全解耦，大幅提升了代码的可维护性和功能的稳定性。

---

## [v5.0.0] - 2025-09-02

### ✨ 新增与增强 (Features & Enhancements)

- **全新回复收藏功能**：
  - 现在可以收藏帖子内的任意楼层回复，方便日后回顾。
  - 在设置面板中新增了独立的“回复收藏”管理标签页，提供强大的搜索功能（支持内容、作者、帖子标题）和关键词高亮。
  - 支持在管理面板中快速跳转到原始帖子楼层。
  - 收藏数据已完全整合到远程同步功能中。
- **远程同步功能全面升级 (安全与稳定)**：
  - **数据完整性校验**：引入 SHA-256 哈希校验机制，在同步前会自动验证云端备份的完整性，从根本上杜绝了因备份损坏导致本地数据被覆盖的风险。
  - **智能冲突处理**：当手动同步检测到云端与本地数据不一致时，会弹出更智能、更清晰的选择界面，明确展示两端数据的最后更新时间，引导用户选择合并方式。
  - **损坏备份修复**：当检测到云端备份文件已损坏时，会主动暂停同步以保护本地数据，并引导用户通过强制推送本地健康的备份来修复云端数据。
  - **向后兼容**：新版同步功能可自动识别并迁移旧版（v3.2）的备份数据结构，实现无缝升级。
- **阅读进度自动清理** M:
  - 新增阅读记录自动清理功能，用户可在“通用设置”中配置清理周期（1 个月、3 个月、6 个月或永不），以自动删除陈旧的阅读记录，保持数据整洁。

### 🎨 UI/UX 优化 (UI/UX Improvements)

- **全新帖子操作菜单**：
  - 彻底重构了帖子列表页的屏蔽操作，使用更紧凑、更现代的三点式操作菜单替代了原有的悬浮按钮，界面更整洁，操作体验更佳。
- **现代化通知系统**：
  - 使用全新的“Toast”通知替代了过去简单的文本提示，动画效果更平滑，且不会打断用户在设置面板中的操作。错误提示增加了抖动动画，更醒目。
- **行内快捷确认**：
  - 在帖子楼层中操作“屏蔽用户”或“删除用户标记”时，使用更快捷的行内确认菜单替代了过去会中断操作流程的弹窗，交互更流畅。
- **设置面板交互升级**：
  - **动态宽度调整**：设置面板的宽度现在可以根据标签页数量自动调整，防止在高分辨率下标签栏换行。
  - **新增分段控件**：引入了更美观、更直观的滑块式分段控件，用于“阅读进度清理”等设置项。
  - **列表操作优化**：在“用户屏蔽”和“用户标记”列表中删除条目时，将平滑地移除该项，而不是刷新整个列表，体验更流畅。
  - **远程同步界面优化**：优化了手动同步冲突选择弹窗的 UI、时间戳显示样式以及教程提示区样式，提升了视觉效果和信息辨识度。

### 🐛 修复 (Bug Fixes)

- **核心布局修复**：
  - **[重大修复]** 采用全新的 Flexbox 布局重写了帖子楼层作者信息栏（`.pi`）的样式，彻底解决了因论坛自身样式缺陷导致的“电梯直达”、“楼主”等元素被遮挡、无法点击或布局错乱的顽固 BUG。
- **兼容性修复**：
  - **置顶帖**：修复了阅读进度跟踪、关键字屏蔽、用户联动屏蔽等多项核心功能对置顶帖不生效的严重问题。
  - **S1 NUX 主题**：重构了样式检测逻辑，解决了脚本部分功能与 S1 NUX 主题样式冲突的问题。
- **远程同步修复**：
  - 修复了导入数据会覆盖本地 Gist ID 和个人访问令牌（PAT）的严重问题。
  - 修复了导入数据后，本地时间戳未同步更新导致版本判断不一致的问题。
- **阅读进度修复**：
  - 增强了帖子 ID 和页码的获取逻辑，使其在搜索结果页等非标准帖子 URL 下也能稳定跟踪阅读进度。
- **交互修复**：
  - 修复了帖子列表中的页码链接不遵循“在新窗口打开”设置的问题。

### 📦 重构 (Refactoring)

- **数据结构升级 (v4.0)**：
  - 为所有导出和远程同步的数据设计了全新的 `v4.0` 结构。新结构将所有核心数据封装在 `data` 字段下，并增加了 `version`、`lastUpdated` 和 `contentHash` 字段，为数据校验和未来迁移提供了坚实基础。
- **同步逻辑重构**：
  - 完全重构了远程同步的底层逻辑，使其完全异步化，并深度整合了哈希校验、版本迁移、冲突判断等机制，代码更清晰，运行更稳定。
- **CSS 架构重构**：
  - 对脚本的 CSS 进行了大规模重构，全面应用 CSS 变量，统一了颜色、间距和组件样式，提高了代码的可维护性和主题扩展性。
- **DOM 操作优化**：
  - 重构了帖子楼层内操作按钮的渲染逻辑，改为更精准、更高效的单点更新模式（`refreshSinglePostActions`），避免了在用户标记、屏蔽后对整个页面的所有帖子进行不必要重绘，提升了性能。

---

## [v4.4.3] - 2025-08-16

### ✨ 新增与增强

- **阅读进度**: 新增“在新窗口打开阅读进度”的设置项，允许用户自由选择点击阅读进度按钮是在新窗口还是当前窗口打开页面，默认为新窗口。

### 🎨 优化与重构

- **阅读进度**: 重构了阅读进度跟踪机制，改为在用户停止滚动后自动保存，并增加了进度回滚保护，显著提升了进度记录的准确性和稳定性，解决了快速跳转或向上滚动时进度丢失或回退的问题。

---

## [v4.4.2] - 2025-08-15

### 修复

- **核心**: 修复了 `visibilitychange` 事件监听器可能被重复添加的问题，提高了脚本的稳定性和性能。

---

## [v4.4.1] - 2025-08-14

### 修复

- **阅读进度跟踪**: 改进了阅读进度跟踪功能，修复了在非帖子列表页面（如导读页）可能出现的脚本错误。

### 优化

- **阅读进度跟踪**: 优化了获取帖子 ID 和页码的逻辑，使其更加稳定可靠。

---

## [v4.4.0] - 2025-08-13

### 修复

- **恢复阅读进度跟踪**: 恢复了在帖子内部跟踪阅读进度的功能，该功能在之前的版本中被意外移除。

---

## [v4.3.0] - 2025-08-13

### ✨ 新增与增强

- **全新用户标记系统**:
  - 可为任意用户添加、编辑或删除自定义文本标记。
  - **统一操作入口**: 将“用户屏蔽”和“用户标记”功能统一整合到帖子楼层顶部的操作栏中，取代了过去悬停在头像上的旧版交互，操作路径更清晰。
  - 为已标记用户提供独立的“编辑/删除”菜单。
  - 在设置中心新增“用户标记”管理面板，可集中管理所有标记，并支持数据导入/导出。
  - 当用户标记过长时，鼠标悬停可显示完整内容的浮窗。
- **新增图片隐藏功能**:
  - 在“通用设置”中增加“默认隐藏帖子图片”的全局开关。
  - 开启后，帖子内的图片将被占位符替代，可点击占位符单独显示图片。
  - 在每层楼内增加“显示/隐藏本楼所有图片”的快捷按钮，方便批量操作。
- **精细化数据清除**: 在“设置同步”中，用更安全的按模块清除数据的工具，替代了过去“一键重置”的危险操作。
- **自动签到**: 增加了 `GM_xmlhttpRequest` 支持，并优化了签到逻辑，使其更稳定可靠。

### 🎨 UI/UX 优化

- **帖子屏蔽交互升级**:
  - **新增二次确认**: 点击“屏蔽”按钮后，需要再次点击“确认”图标方可屏蔽，有效防止误操作。
  - **全新动画效果**: 重做了屏蔽按钮的交互，通过平移动画为按钮腾出空间，视觉效果更平滑。
  - **按钮重新设计**: 将确认/取消操作升级为更现代化的 SVG 图标按钮。
- **阅读进度显示优化**:
  - **精确显示新回复**: 通过记录楼层号，可精确计算并显示 `+N` 条新回复。
  - **优化信息展示**: 跳转按钮会显示为 `P<页码>-#<楼层号>`，并增加了图标，信息更直观。
- **设置面板重构**:
  - **布局调整**: 将原“界面定制”拆分为“导航栏定制”和“通用设置”，功能划分更清晰。
  - **交互优化**: 为各功能模块增加了独立的启用开关，并配合更平滑的展开/折叠动画。
- **文本优化**: 将帖子楼层中的“只看该作者”统一修改为“只看该用户”，描述更准确。
- **移除头像悬浮层**: 移除了旧版在用户头像上的悬停屏蔽按钮和标记弹窗，解决了因头像加载延迟导致的按钮错位、闪烁或不显示的问题。

### 🐛 修复

- **核心布局修复**: 修复了论坛帖子作者信息栏 `.pi` 的高度塌陷问题，解决了其背景可能遮挡“电梯直达”、“楼主”等链接导致无法点击的 BUG。
- **功能兼容性**: 修复了脚本操作按钮与论坛原生的“只看该作者”、“回复”等按钮的布局冲突和样式问题。

### 📦 技术与重构

- **数据结构升级**: 升级了用户标记、阅读进度等功能的数据结构，并内置了从旧版本自动迁移数据的逻辑。
- **代码重构**: 对核心的 DOM 变动监测逻辑 (`MutationObserver`) 进行了重构，改为更高效、更稳定的 `applyChanges` 流程。

---

## [v4.2.0] - 2025-08-09

### ✨ 新增与增强

- **自定义页面标题**: 在“界面定制”设置中，新增了修改页面标题后缀的功能，方便用户个性化浏览器标签页的显示。
- **随机图更换**: 点击漫区顶部的随机图，可以立即更换一张新的图片。

### 🎨 UI/UX 优化

- **“继续阅读”按钮优化**: 将帖子列表中的“回到第 X 页”的阅读进度跳转按钮移至页码栏之后，并调整了样式，使其更醒目且不干扰标题浏览。
- **帖子屏蔽按钮交互改进**: 帖子屏蔽按钮仅在鼠标悬停于帖子最左侧时出现，减少了对视线的干扰。
- **UI 风格统一**:
  - **颜色体系**: 全面应用了新的全局颜色变量，使脚本的所有 UI 元素（按钮、弹窗、设置面板等）在颜色上与 S1 论坛的默认主题更贴合、更统一。
  - **组件前缀统一**: 将所有 CSS 类名和 ID 的前缀统一为 `s1p-`，规范了代码并避免了潜在的样式冲突。
- **设置面板重新设计**: 对设置面板的整体 UI 进行了重新设计，包括标签页、按钮、输入框、列表项等，使其布局更清晰，视觉效果更佳。
- **用户标记悬浮窗重新设计**: 重新设计了用户标记的悬浮窗，优化了布局和样式，使其更美观易用。

### 📦 构建与重构

- **发布流程**: 添加了标准化的发布命令，简化了版本发布流程。
- **CSS 重构**: 使用 CSS 全局变量重构了样式代码，提高了可维护性和主题扩展性。
- **代码重构**: 优化了屏蔽用户引用和评分的处理逻辑。

---

## [v4.1.0] - 2025-08-05

### ✨ 功能增强

- **优化引用屏蔽样式与动画**:
  - **样式优化**: 将被屏蔽引用的占位符从灰色背景盒子改为更简洁的文本样式，并将“展开/折叠”按钮更新为与设置面板统一的圆角矩形按钮。
  - **增加动画**: 为引用的展开和折叠过程增加了平滑的 `max-height` 过渡动画，提升了视觉效果和用户体验。
  - **动画修复**: 解决了动画过程中因高度计算不精确导致的显示不完整和布局偏移问题，确保动画的流畅和稳定。
- **优化引用屏蔽体验**:
  - **即时生效**: 修复了屏蔽用户后，其引用不会立即隐藏，需要手动刷新页面的问题。
  - **占位符替换**: 被屏蔽用户的引用不再是直接消失，而是被一个更友好的占位符替换，提示“一条来自已屏蔽用户的引用已被隐藏。”。
  - **临时查看**: 占位符提供“点击展开/折叠”功能，允许临时查看被屏蔽的引用内容。
  - **样式优化**: 优化了占位符及其按钮的样式，使其在视觉上更贴合论坛和脚本的整体风格，并调整了边距以避免占满整个内容宽度。

---

## [v4.0.2] - 2025-08-05

### 🐛 问题修复

- **修复评分帖子隐藏错误**: 解决了屏蔽用户后，可能会错误地将该用户评分过的帖子整体隐藏的问题。新的实现能更精确地定位并只隐藏发帖者为被屏蔽用户的帖子。
- **修复评分状态刷新**: 修复了取消屏蔽用户后，其评分记录不会立刻重新显示的问题。现在，无论是屏蔽还是取消屏蔽，相关评分的可见性都会即时更新。

### 🐛 问题修复

- **修复用户屏蔽按钮显示异常**: 重构了在用户头像上添加屏蔽按钮的逻辑，通过等待图片完全加载后才计算按钮位置和大小，彻底解决了因网络延迟或图片缓存问题导致的悬浮按钮错位、尺寸不正确或不显示的 BUG。

### ⚡️ 性能优化

- **优化页面变化监测性能**: 将 `MutationObserver` 的监听范围从整个页面 (`body`) 精准地缩小到内容区域 (`#ct`)，显著减少了不必要的脚本重复运行，降低了性能开销，提升了页面流畅度。

---

## [v4.0.0] - 2025-08-02

### 维护

- **清理项目文件:** 删除了一个不再需要的截图文件 (`longshot20250802025336.png`)，以保持项目仓库的整洁。

### 优化

- **用户标记浮窗 (User Tagging Popover):**
  - **UI/UX 大修:** 完全重新设计了用户标记浮窗，使其具有更现代化、更美观的界面。
    - **页脚信息:** 浮窗现在会显示用户的头像、用户名和 UID，信息更一目了然。
    - **动态布局:** 浮窗宽度会根据内容（如用户名长度）动态调整，防止文本溢出。
    - **统一按钮风格:** 更新了浮窗内的所有按钮（添加、编辑、删除、保存、取消），使其默认显示为灰色，并在鼠标悬停时分别变为蓝色（常规操作）或红色（删除操作），与脚本的整体风格保持一致。
  - **功能改进:**
    - **输入法兼容性:** 修复了在使用输入法（IME）输入时，浮窗会意外关闭的问题。

### 🎨 优化与重构

- **UI 微调与版本更新**：
  - 优化了用户标签浮窗中操作按钮的 padding、字体大小和圆角，使其视觉上更精致、协调。
  - 将设置面板内列表项的背景色恢复为淡灰色 (`#f9fafb`)，以修正之前版本中过于刺眼的纯白背景，确保了整体 UI 风格的统一性和舒适度。
  - 更新脚本版本号至 `3.2.2`。

### 🎨 优化与重构

- **优化用户标签浮窗样式 (v4)**：
  - **全新视觉设计**：重新设计了用户标签浮窗，采用现代化的半透明玻璃效果 (backdrop-filter)，并优化了边框、阴影和配色，使其更具质感和美观度。
  - **增强交互体验**：为浮窗内的按钮（如编辑、删除）添加了清晰的 SVG 图标，提升了可识别性。同时，改善了按钮的交互动画和高亮效果，使操作反馈更直观。
  * **改善布局与内容**：调整了浮窗内部的布局、间距和字体样式，提升了信息的可读性。在没有标签时，会显示更友好的提示信息。

### 🎨 优化与重构

- **优化悬浮窗交互**：通过增加延迟显示和优化隐藏逻辑，改善了鼠标在用户头像上快速划过时的体验，避免了不必要的浮窗闪烁，使其交互更加稳定和流畅。

### ✨ 新增与增强

- **初步增加用户标记功能**：当鼠标悬停在用户头像上时，会显示一个悬浮窗，为后续的标记、编辑和删除功能打下基础。

### 🎨 优化与重构

- **重构悬浮窗交互**：采用事件委托和智能延迟机制重写了悬浮窗的显示/隐藏逻辑，彻底解决了因鼠标快速移动导致的闪烁和异常消失问题，交互体验更稳定、流畅。
- **优化悬浮窗 UI**：重新设计了用户标记浮窗的 UI，使其在视觉风格上与脚本整体保持和谐统一，并提升了布局的清晰度和美观度。

### 🐛 问题修复

- **修复 UI 遮挡问题**：通过将悬浮窗挂载到 `body` 而非表格单元格，从根本上解决了其被帖子内容区域遮挡的问题。
- **修复功能冲突**：清除了所有导致新旧功能冲突的 CSS 和 JS 代码，确保了“屏蔽用户”等原有功能的 UI 和交互恢复正常。

### 🎨 优化与重构

- **优化设置项交互**:
  - 将设置面板中的所有复选框（Checkbox）替换为更现代、更直观的拨动开关（Toggle Switch），提升了视觉效果和操作体验。
  - 改进了“标题关键字屏蔽”功能的工作流，将自动实时保存改为手动点击“保存规则”按钮确认，避免了误操作和不必要的性能开销，并增加了操作成功提示。

### 🎨 优化与重构

- **统一 UI 颜色**: 脚本中所有功能性红色（如删除、恢复默认、错误提示等）统一为 `#ef4444`，以增强视觉一致性。
- **优化导航栏编辑器**:
  - 修复了拖拽排序时条目变灰且排序不稳定的问题，提升了拖拽体验。
  * 移除了保存设置时的成功提示，使交互流程更简洁。
- **更新图标**: 将编辑器中的“删除”操作从文字图标 '✖' 升级为更现代、更直观的 SVG 垃圾桶图标，并优化了其高亮交互效果。

### ✨ 新增与增强

- **新增标题关键字屏蔽**: 新增通过关键字或正则表达式屏蔽帖子的功能，并包含独立的规则编辑器。
- **新增用户评分屏蔽**: 现在屏蔽一个用户后，其在帖子下的所有评分记录（战斗力、理由等）也会被自动隐藏。

### 🎨 优化与重构

- **重构关键字屏蔽编辑器**:
  - 移除了“保存规则”按钮，改为自动实时保存机制，并为输入框增加了 400ms 防抖以优化性能。
  - 优化了工作流：新增的规则默认不启用，并去除了频繁的保存提示。
- **设置面板 UI 重构**:
  - 将“帖子屏蔽”页的列表重构为可平滑折叠的区域，优化了空间利用。
  - 增强了“界面定制”中的导航链接编辑器，提供了更清晰的布局和拖拽手柄。
  - 将设置面板的关闭按钮替换为更现代的 SVG 图标。
- **核心与数据**:
  - “设置同步”功能现已完全支持新的关键字屏蔽规则。
  - 实现了对旧版本关键字数据的自动迁移，确保无缝升级。

### 🐛 问题修复

- 修复了从搜索结果页等特定链接 (`mod=viewthread`) 进入帖子后，用户屏蔽功能不生效的问题。
- 修复了关键字编辑器在旧版手动保存逻辑下，会导致 UI 组件无响应和输入框重复出现的严重 BUG。

---

## [v3.0.1] - 2025-07-28

### 🐛 问题修复

- 修复了从搜索结果页打开帖子时，用户屏蔽功能不生效的问题。

---

## [v3.0] - 2025-07-27

### ✨ 新增与增强

- **新增“跳转至上次阅读位置”功能 (v3.0)**：
  - **自动记录进度**：在浏览帖子时，脚本会自动在后台记录您看到的最后一个回复的位置。
  - **快速跳转链接**：在帖子列表页面，对于有阅读记录的帖子，标题旁边会显示一个 `[跳转]` 链接，点击即可直接跳到上次中断的地方，无缝衔接您的阅读体验。
- **联动屏蔽功能 (v2.8)**：现在当您屏蔽一个用户时，可以选择同时屏蔽该用户发布的所有主题帖。
- **全量设置同步 (v2.8)**：同步功能得到全面增强，可以一键导出/导入所有配置，包括屏蔽列表、导航栏和各项开关的状态。

### 🎨 优化与重构

- **设置面板重构 (v2.8)**：设置面板重构为四个独立的标签页，功能划分更清晰。
- **代码结构优化**：对多个功能模块进行了代码优化和重构，提升了脚本的稳定性和可维护性。

---

## [v2.7] - 2025-07-26

### 🐛 问题修复

- 修复了自动签到功能在多账号切换时状态不互通的问题。

---

## [v2.6] - 2025-07-26

### 🐛 问题修复

- 修复了自动签到功能被移除的问题。

---

## [v2.5] - 2025-07-26

### 🎨 优化与重构

- **帖子屏蔽按钮 UI**：重做并升级了帖子屏蔽按钮的 UI 和交互，采用更现代化的悬浮标签样式，并增加了更平滑的动画效果，提升了操作直观性和视觉体验。

---

## [v2.4] - 2025-07-26

### ✨ 新增与增强

- **新增“界面定制”功能**：
  - **自定义导航栏**：允许通过拖拽方式自由管理导航链接。
  - **调整界面元素**：可修改论坛 Logo 链接及隐藏屏蔽用户发言的提示条。

### 🎨 优化与重构

- **设置管理**：重构了设置的保存与加载逻辑，使所有界面定制选项均可即时生效。
- **代码结构**：对 UI 创建和事件处理部分的代码进行了模块化重构。

---

## [v2.3] - 2025-07-26

### 🐛 问题修复

- **样式兼容性**：调整了屏蔽按钮的 CSS，解决了与自定义主题（如 “S1 NUX”）的样式冲突问题。

---

## [v2.2] - 2025-07-26

### 🎨 优化与重构

- **确认弹窗**：重写了屏蔽用户的确认弹窗，替换系统默认弹窗，统一了 UI 风格并增加了动画效果，提升了用户体验。

---

## [v2.1] - 2025-07-26

### ✨ 新增与增强

- 在“屏蔽管理”面板的页脚增加了版本号和发布日期显示。

### 🎨 优化与重构

- 移除了脚本文件内嵌的更新日志等注释，使代码更简洁。

---

## [v2.0] - 2025-07-26

### ✨ 新增与增强

- **新增用户屏蔽核心功能**：支持鼠标悬停于用户头像上进行屏蔽。

### 🎨 优化与重构

- **屏蔽管理界面**：重新设计管理弹窗，使用选项卡区分“帖子屏蔽”与“用户屏蔽”。
- **数据同步**：更新了导入/导出功能，使其能同时处理帖子和用户的屏蔽数据。
- **UI/UX**：改进了屏蔽按钮的交互动画和视觉样式。

---

## [v1.0 - v1.9]

- **v1.9**：修复了自动签到功能在多账号切换时状态不互通的问题。
- **v1.8**：新增自动签到功能；并修复了部分情况下帖子列表第一个帖子不显示屏蔽按钮的 bug。
- **v1.7**：整合了 `@match` 指令，提高匹配效率。
- **v1.6**：新增设置项允许用户选择屏蔽按钮显示位置；并优化了设置项体验，关闭窗口后自动刷新页面。
- **v1.5**：修复了帖子详情页面不显示“屏蔽管理”按钮的 bug。
- **v1.4**：优化了屏蔽按钮样式，增加字体粗细。
- **v1.3**：增加了屏蔽按钮右侧间距，解决与“New”标签重叠问题。
- **v1.2**：添加了置顶帖屏蔽功能。
- **v1.1**：添加了多设备同步功能并优化了 UI。
- **v1.0**：初始版本发布，实现了基本的帖子屏蔽功能和管理界面。