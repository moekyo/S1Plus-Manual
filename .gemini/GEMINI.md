# S1Filter-Manual 项目说明

本项目 `S1Filter-Manual` 包含一个用户脚本（`S1Plus.user.js`）和一个用户样式（`S1 NUX.css`），旨在全方位增强 Stage1st 论坛（saraba1st.com / stage1st.com）的浏览体验。

## 核心组件

### `S1Plus.user.js` (用户脚本)

此脚本是功能的核心，通过 Tampermonkey 或 Greasemonkey 等浏览器扩展运行，为论坛添加了大量实用功能。

**主要功能:**

*   **帖子屏蔽**:
    *   **悬停屏蔽与二次确认**: 在帖子列表页，鼠标悬停即可浮现屏蔽按钮，点击后需二次确认，防止误操作。
    *   **关键字/正则表达式屏蔽**: 在设置中添加自定义规则，自动屏蔽标题符合规则的帖子。

*   **用户屏蔽与管理**:
    *   **一键屏蔽**: 在帖子楼层底部的操作栏中，可一键屏蔽用户。
    *   **联动屏蔽**: 可选择在屏蔽用户的同时，自动屏蔽其发布的所有主题帖，并可在设置中为每个已屏蔽用户独立开关此选项。
    *   **智能引用处理**: 来自已屏蔽用户的引用会被自动折叠，但可点击展开查看。
    *   **屏蔽用户评分**: 自动隐藏来自已屏蔽用户的评分记录。

*   **用户标记系统**:
    *   **行内标记与操作**: 直接在帖子楼层中进行用户标记的添加、编辑和删除操作，无需额外弹窗。
    *   **快捷菜单**: 通过用户标记旁的菜单，可快速执行编辑或删除。
    *   **悬浮提示**: 当标记内容过长时，鼠标悬停即可显示完整信息。
    *   **集中管理**: 在设置面板中，可以集中查看、编辑、删除所有用户的标记，并支持独立的导入和导出。

*   **图片/多媒体隐藏**:
    *   **默认隐藏图片**: 可在设置中开启，默认将帖子内的所有图片折叠为占位符。
    *   **一键切换**: 在图片较多的楼层，会自动生成“显示/隐藏本楼所有图片”的按钮。

*   **阅读进度跟踪**:
    *   **精确记录**: 自动记录每个帖子的最后阅读位置（页数和楼层）。
    *   **快速跳转与新回复提示**: 在帖子列表页，为有阅读进度的帖子生成一个快捷跳转按钮（如 `P2-#35`），并显示新回复数量角标（如 `+5`）。

*   **界面与导航定制**:
    *   **自定义导航栏**: 在设置中可以自由添加、删除或拖拽排序主导航栏的链接。
    *   **界面微调**: 提供多种界面定制选项，例如修改论坛 Logo 链接、隐藏黑名单提示、自定义浏览器标签页标题等。

*   **自动签到**:
    *   访问论坛时，脚本会自动检查并执行每日签到操作。

*   **设置同步与管理**:
    *   提供全功能的导入/导出系统，可通过 JSON 数据在不同设备或浏览器之间同步所有设置。
    *   **精细化数据清除**: 提供高级工具，允许用户选择性地清除脚本的某一部分数据（如仅清除阅读进度），并有二次确认防止误操作。

**实现方式:**

*   使用 `GM_setValue` 和 `GM_getValue` 进行数据的持久化存储。
*   使用 `GM_addStyle` 动态注入脚本所需的 CSS 样式。
*   通过 `MutationObserver` 监听页面的 DOM 变化，确保功能（如屏蔽、添加按钮）能正确应用于由 AJAX 动态加载的内容。
*   内置数据迁移逻辑，可兼容旧版本脚本的数据格式。


## 安装与使用

### `S1Plus.user.js` (用户脚本)

1.  在浏览器中安装一个用户脚本管理器（如 [Tampermonkey](https://www.tampermonkey.net/) 或 [Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)）。
2.  打开 `S1Plus.user.js` 文件，或将其拖拽到浏览器中，脚本管理器会自动弹出安装提示。
3.  确认安装。


### 配置入口

安装完成后，论坛顶部主导航栏会出现一个新的 **“S1 Plus 设置”** 链接。点击此链接即可打开设置面板，对上述所有功能进行详细配置。

## 开发注意事项

*   脚本功能依赖 Greasemonkey API (`GM_*` 函数)，开发和调试时需在对应的环境中进行。
*   脚本通过 `MutationObserver` 响应页面动态内容，修改时需注意其性能和触发时机。
*   在修改 UI 相关的功能或样式时，应注意与现有风格保持一致，并确保在不同主题下的显示效果。
*   进行任何修改前，请充分理解现有代码逻辑，避免引入破坏性变更或影响已有功能。
*   各个 UI 元素颜色都使用在 CSS 表中增加全局颜色值
*   相关 class 和 ID 前缀为 s1p
*   如果要实现的功能过于复杂，把整个功能拆分成多个子功能，逐步实现。